{% extends "base.html" %}
{% load avatar %}
{% block title %}Edit Profile — {{ block.super }}{% endblock %}
{% block content %}
  <section class="panel">
    <h2>Edit Profile</h2>
    <div class="mb-2">
      <img src="{% avatar_url request.user 64 %}" alt="{{ request.user.username }}" class="avatar-lg" />
    </div>
    <form method="post" action="" enctype="multipart/form-data" class="profile-form">
      {% csrf_token %}
      {{ form.non_field_errors }}
      <div class="kv">
        <label for="id_full_name">Full name</label>
        {{ form.full_name }}
        <label for="id_phone">Phone</label>
        {{ form.phone }}
        <label for="id_email">E‑mail</label>
        {{ form.email }}
        <label for="id_current_password">Current password</label>
        {{ form.current_password }}
        <label class="nowrap" for="id_avatar">Avatar (JPEG/PNG/WEBP, &le; 2&nbsp;MB)</label>
        {{ form.avatar }}
      </div>
      {% if profile_obj.avatar %}
        <p class="mt-2">
          <img src="{{ profile_obj.avatar.url }}" alt="Current avatar" class="avatar" />
          <button type="submit" name="remove_avatar" value="1" class="btn-link">Remove uploaded avatar</button>
        </p>
      {% else %}
        <p class="muted mt-2">No uploaded avatar. A generated avatar will be used.</p>
      {% endif %}
      <button type="submit" class="btn">Save changes</button>
      <a class="btn-secondary" href="/accounts/password/change/">Update password</a>
      <a href="/accounts/home/">Cancel</a>
    </form>
  </section>
{% endblock %}
